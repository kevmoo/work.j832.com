---
layout: post
title: A REAL update to the Bag-o-Tricks
date: '2008-01-12T18:30:00.001-08:00'
author: Kevin Moore
tags:
- WPF
- ".NET"
- C#
modified_time: '2008-01-12T18:35:35.356-08:00'
blogger_id: tag:blogger.com,1999:blog-2115056243892631308.post-3323685071468410300
blogger_orig_url: http://work.j832.com/2008/01/real-update-to-bag-o-tricks.html
---

<p>The <a href="http://work.j832.com/2007/12/bag-o-tricks-christmas-edition.html">last update</a> to the <a href="http://j832.com/bagotricks/">bag-o-tricks</a> was pretty lame, I'll admit.</p>  <p>As I <a href="http://work.j832.com/2007/12/when-you-code-do-you-know-your-masters.html">discussed</a> a bit ago, a lot of people code to &quot;get it done yesterday&quot;. It's clear, looking through a bunch of the code, that I had this mentality about a lot of the samples. Moreover, it's clear that the masters of code quality, maintainability, and best-practices were often ignored.</p>  <p>Here's an attempt to put my money where my mouth is. </p>  <h3>The Goods</h3>  <p><a href="http://j832.com/bagotricks/wpfbagotricks.zip">Binaries and Source</a> [zip, 4.3MB]. <em>Developed with Visual C# Express 2008.</em></p>  <h3>The Details</h3>  <ul>   <li><strong>Set - <em>New!</em></strong>       <ul>       <li>The XBap I <a href="http://work.j832.com/2008/01/wpf-set-xbap.html">posted last week</a> is now part of the bag-o-tricks. </li>        <li>Did some clever project linking to allow building XBap without duplicating files. </li>     </ul>   </li>    <li><strong>Interactive 3D - <em>New!</em></strong>       <ul>       <li>Added the 3D demos I <a href="http://work.j832.com/2008/01/wpf-35-demo-posted-add-ins-and.html">discussed</a> a while ago </li>        <li>A lot of clean-up to make the code more suitable for general use </li>     </ul>   </li>    <li><strong>AnimatingTilePanel</strong>       <ul>       <li>Ability to animate in newly added items </li>        <li>Made dampening make sense: bigger number = more dampening </li>        <li>Add Variation property to make item movement make more organic, if desired </li>        <li>Added validation to the public properties </li>        <li>Moved frame tick register/de-register to new CompositionTargetRenderingListener </li>        <li>Perf: Stopped &#8216;ticking&#8217; when nothing is changing </li>        <li>Stopped using clock time between ticks to affect animation: complexity with little benefit </li>        <li>Made ItemHeight/Width attached properties that can be added to a host ItemsControl. </li>        <li>Demo: moved to DemoCollection -&gt; now you can see how changes to the source collection are reflected </li>     </ul>   </li>    <li><strong>Graph</strong>       <ul>       <li>Removed a completely silly use a Dictionary. Clever perf optimization that made the code bloated, confusing, and probably slower. </li>        <li>Renamed CoefficientOfDampening -&gt; Dampening </li>        <li>Rename FrameRate -&gt; Attraction </li>        <li>Removed unneeded HideAnimationManager -&gt; thank you anonymous methods. </li>        <li>Demo: A bunch of clean-up in the Node data files. Should never have used DispaterObject. </li>        <li>Demo: Moved to dispatcher timer for churning the graph nodes: a lot cleaner and more efficient than a separate Thread. </li>     </ul>   </li>    <li><strong>Zap</strong>       <ul>       <li>Removed shameful implementation of IPropertyChanged on top of a DependencyObject </li>        <li>Eliminated gratuitous subclassing of DependencyObject by ZapCommandItem </li>        <li>Removed FirstPreviousNextLastCommand (and associated enum) -&gt; thank you ActionICommand </li>        <li>Fixed some pretty glaring bugs in not-so-edge cases </li>        <li>Demo: moved to DemoCollection </li>     </ul>   </li>    <li><strong>ActionICommand - <em>New!</em></strong>       <ul>       <li>Commands often expose the functionality of existing methods. So why can&#8217;t exposing a command be as simple as wrapping the existing method? Exactly. </li>     </ul>   </li>    <li><strong>WrapperElement - <em>New!</em></strong>       <ul>       <li>A while ago, I <a href="http://work.j832.com/2007/06/don-subclass-panel-unless-you-making.html">discussed</a> not subclassing Panel unless you&#8217;re making a Panel. Well, sometimes all you want to do is compose a single element without exposing it's state to the world. WrapperElement makes the process of wrapping a child element trivial.</li>     </ul>   </li>    <li><strong>CompositionTargetRenderingListener - <em>New!</em></strong>       <ul>       <li>A class that can be used to manage listening to the static CompositionTarget.Rendering event. I use this pattern so much, it made sense to make a separate class. </li>     </ul>   </li>    <li><strong>Demo: DemoCollection - <em>New!</em></strong>       <ul>       <li>Writing controls that handle INotifyCollectionChange can be tough. Wouldn&#8217;t it be nice to have a class that makes testing (and then showing off) your list-bound control easy? I thought so.</li>     </ul>   </li>    <li><strong>General</strong>       <ul>       <li>Removed a lot of unused parameters and privates. Thanks, <a href="http://en.wikipedia.org/wiki/FxCop">FxCop</a>. </li>        <li>Demo: Moved the introduction page to FlowDocument. Why I didn&#8217;t do this a year ago, I&#8217;ll never know. </li>     </ul>   </li> </ul>  <p>As always, the <a href="http://j832.com/PublicSoftware/">SVN location</a> has been updated. Patches are always welcome (No one has taken me up on this yet. Would love to try it out.)</p>  <p>Enjoy and happy hacking!</p>  