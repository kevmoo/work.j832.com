---
layout: post
title: Equality and Dart
date: '2014-05-26T18:07:00.001-07:00'
author: Kevin Moore
tags:
- dartlang
- Programming
- dart
modified_time: '2014-05-26T18:19:51.776-07:00'
thumbnail: http://2.bp.blogspot.com/-Xj6x0dbVPxA/U1wrVMg0RZI/AAAAAAAALeo/DNGDK-X01Ws/s72-c/dart_logo_simple.png
blogger_id: tag:blogger.com,1999:blog-2115056243892631308.post-3436597055505584844
blogger_orig_url: http://work.j832.com/2014/05/equality-and-dart.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-Xj6x0dbVPxA/U1wrVMg0RZI/AAAAAAAALeo/DNGDK-X01Ws/s1600/dart_logo_simple.png" imageanchor="1" style="margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://2.bp.blogspot.com/-Xj6x0dbVPxA/U1wrVMg0RZI/AAAAAAAALeo/DNGDK-X01Ws/s640/dart_logo_simple.png" /></a></div><p>A month ago <a href="http://work.j832.com/2014/04/there-are-at-least-two-things-wrong.html">I asked a question on my blog</a> about a piece of Dart code.</p><p>For the below class, what are at least two things wrong with the implementation of <code>operator ==</code>.</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Foo</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> _a</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> _b</span><span class="pun">;</span><span class="pln"><br /><br />  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> a </span><span class="pun">=&gt;</span><span class="pln"> _a</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> b </span><span class="pun">=&gt;</span><span class="pln"> _b</span><span class="pun">;</span><span class="pln"><br /><br />  </span><span class="pun">...</span><span class="pln"><br /><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Foo</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />    </span><span class="kwd">return</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">_a </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">_a </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">_b </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">_b</span><span class="pun">;</span><span class="pln"><br />  </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>A number of guesses were posted to the <a href="https://plus.google.com/+KevinMoore314/posts/KK2qkT2cJ4S">G+ discussion</a>.</p><h1 id="context-designing-types-for-reuse-it-tough">Context: designing types for reuse is tough</h1><p>If <code>Foo</code> is only used within one library – so it should be named <code>_Foo</code> – the existing implementation <strong>might be totally fine</strong>.</p><p>But if <code>Foo</code> is…</p><ul><li>Used a lot within a single library or package</li><li>Part of a code base with a lot of developers</li><li>Part of a public package</li><li>Serves as a base class</li></ul><p>…then you have to think a lot harder about its implementation.</p><h1 id="special-equality">Special Equality</h1><p>The parameter to <code>operator ==</code> should always be <code>Object</code>.</p><p>Don’t believe me? Paste the code below into <a href="http://try.dartlang.org/">try.dartlang.org</a>. I’ll wait.</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">void</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">var</span><span class="pln"> items </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Bar</span><span class="pun">(</span><span class="lit">5</span><span class="pun">),</span><span class="pln"> </span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">];</span><span class="pln"><br />  </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">items</span><span class="pun">.</span><span class="pln">contains</span><span class="pun">(</span><span class="lit">6</span><span class="pun">));</span><span class="pln"><br /></span><span class="pun">}</span><span class="pln"><br /><br /></span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Bar</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> value</span><span class="pun">;</span><span class="pln"><br />  </span><span class="typ">Bar</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">value</span><span class="pun">);</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Bar</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> value </span><span class="pun">==</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">value</span><span class="pun">;</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p><code>operator ==</code> is used in <code>Iterable</code> for <code>contains</code>, <code>where</code>, and many other methods. <code>Map</code> also uses <code>==</code> for its final check after finding matching hash codes. If there is any chance that an instance of your class will have equality checked with any other type – either directly or via <em>very</em> common Dart classes – you should not make assumptions about the argument to <code>==</code> except that it’s not <code>null</code>. Dart takes care of the <code>null</code> check for you.</p><p>This is easy to fix:</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Bar</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> value</span><span class="pun">;</span><span class="pln"><br />  </span><span class="typ">Bar</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">value</span><span class="pun">);</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Object</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> <br />    other </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Bar</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> value </span><span class="pun">==</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">value</span><span class="pun">;</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><h1 id="general-equality">General Equality</h1><p>Just like relativistic physics, the special case is pretty straight forward. The general case is a bear.</p><p><em>I read that Special Relativity took Einstein 8 weeks where General Relativity took him 8 years, but I digress.</em></p><p>The special case is a black-and-white comparison: is the operand the same type as <code>this</code> or not. The general case introduces a pile of gray.</p><p>Dart has <a href="https://www.dartlang.org/docs/dart-up-and-running/contents/ch02.html#ch02-implicit-interfaces">implicit interfaces</a>. This means anyone can implement your <code>Foo</code> or <code>Bar</code> class.</p><p>Let’s say we fixed our original example for the special case:</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Foo</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> _a</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> _b</span><span class="pun">;</span><span class="pln"><br /><br />  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> a </span><span class="pun">=&gt;</span><span class="pln"> _a</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> b </span><span class="pun">=&gt;</span><span class="pln"> _b</span><span class="pun">;</span><span class="pln"><br /><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Object</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />    </span><span class="kwd">return</span><span class="pln"> other </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">Foo</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">_a </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">_a </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">_b </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">_b</span><span class="pun">;</span><span class="pln"><br />  </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>What if someone <code>implements Foo</code> in another library.</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">import</span><span class="pln"> </span><span class="str">'package:foolib/foolib.dart'</span><span class="pun">;</span><span class="pln"><br /><br /></span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyFoo</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">Foo</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> a </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="lit">41</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> b </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="lit">42</span><span class="pun">;</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>Try doing <code>if (foo == myFoo)</code>.</p><p>You’ll get a runtime error along the lines of <code>MyFoo does not have instance property _a</code>.</p><h1 id="general-equality-simple-fix">General Equality: simple fix</h1><p>The simple fix is, well, simple. Avoid using private members of objects you don’t completely control. In the case of <code>==</code> that means any private members on <code>other</code>.</p><p>This problem goes beyond <code>operator ==</code> and extends to <em>any</em> method <em>anywhere</em> in your library.</p><p>Consider the static <code>distance</code> method below.</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  num _x</span><span class="pun">,</span><span class="pln"> num _y</span><span class="pun">;</span><span class="pln"><br />  num </span><span class="kwd">get</span><span class="pln"> x </span><span class="pun">=&gt;</span><span class="pln"> _x</span><span class="pun">;</span><span class="pln"><br />  num </span><span class="kwd">get</span><span class="pln"> y </span><span class="pun">=&gt;</span><span class="pln"> _y</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> distance</span><span class="pun">(</span><span class="typ">MyPoint</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />    </span><span class="com">// should you access _x or _y here?</span><span class="pln"><br />  </span><span class="pun">}</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>See what I mean?</p><h1 id="general-equality-simple-mistakes">General Equality: simple mistakes</h1><p>Avoiding private members is only part of the problem. Let’s look at <code>MyPoint</code> again.</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">final</span><span class="pln"> num x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">;</span><span class="pln"><br />  </span><span class="typ">MyPoint</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Object</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"><br />    other </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">y </span><span class="pun">==</span><span class="pln"> y</span><span class="pun">;</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>No private members. No type assumptions. We’re home free! Right?</p><p>Try this in <a href="http://try.dartlang.org/">try.dartlang.org</a>:</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">final</span><span class="pln"> num x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">;</span><span class="pln"><br />  </span><span class="typ">MyPoint</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">y</span><span class="pun">);</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Object</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"><br />    other </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">y </span><span class="pun">==</span><span class="pln"> y</span><span class="pun">;</span><span class="pln"><br /></span><span class="pun">}</span><span class="pln"><br /><br /></span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MyPoint3</span><span class="pln"> </span><span class="kwd">extends</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">final</span><span class="pln"> num z</span><span class="pun">;</span><span class="pln"><br />  </span><span class="typ">MyPoint3</span><span class="pun">(</span><span class="pln">num x</span><span class="pun">,</span><span class="pln"> num y</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">z</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">super</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">);</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Object</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"><br />    other </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">MyPoint3</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">y </span><span class="pun">==</span><span class="pln"> y </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">z </span><span class="pun">==</span><span class="pln"> z</span><span class="pun">;</span><span class="pln"><br /></span><span class="pun">}</span><span class="pln"><br /><br /></span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">var</span><span class="pln"> mp </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MyPoint</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">);</span><span class="pln"><br />  </span><span class="kwd">var</span><span class="pln"> mp3 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MyPoint3</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="lit">3</span><span class="pun">);</span><span class="pln"><br /><br />  </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">mp </span><span class="pun">==</span><span class="pln"> mp3</span><span class="pun">);</span><span class="pln"> </span><span class="com">// true</span><span class="pln"><br />  </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">mp3 </span><span class="pun">==</span><span class="pln"> mp</span><span class="pun">);</span><span class="pln"> </span><span class="com">// false</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>You’ve just broken one of the <a href="http://mathworld.wolfram.com/EquivalenceRelation.html">three laws of equality</a>. </p><p>Cue <a href="http://youtu.be/JmzuRXLzqKk">mass hysteria</a>.</p><p>There <em>are</em> solutions to this problem, but they are not simple. We’ll have to bother <a href="https://www.google.com/+FlorianLoitsch">Florian Loitsch</a> for details.</p><p>…and I haven’t even gotten into implementing <code>hashCode</code> and handling mutable fields – <a href="http://blog.mgm-tp.com/2012/03/hashset-java-puzzler/">here’s a taste</a>.</p><h1 id="now-what">Now what?</h1><p>Keep calm, but be paranoid.</p><ul><li>Be careful when implementing <code>==</code>. <br /><ul><li>Make sure it’s something you want to sign up for.</li><li>Read up on implementing <code>hashCode</code> correctly.</li><li>If you’re class has mutable state, be afraid!</li></ul></li><li>Always type the argument to <code>operator ==</code> as <code>Object</code> and do a type check.</li><li>If your class is public, remember: any instance of <code>Foo</code> may not be <em>my</em> implementation of <code>Foo</code>. <br /><ul><li>Stick to the public interface.</li><li>Document what you consider equality.</li></ul></li></ul><h1 id="an-alternative-public-class-private-implementation">An alternative: public class, private implementation</h1><p>If you’ve dug around the Dart source code, you’ve likely seen this pattern:</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">abstract</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">SomeClass</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> a</span><span class="pun">;</span><span class="pln"><br />  </span><span class="typ">String</span><span class="pln"> </span><span class="kwd">get</span><span class="pln"> b</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> someMethod</span><span class="pun">();</span><span class="pln"><br /><br />  factory </span><span class="typ">SomeClass</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">_SomeClassImpl</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">);</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>Besides allowing us to efficiently support both the Dart virtual machine and compiling to Javascript, this pattern also allows one to detect random implementations of a type.</p><pre class="prettyprint prettyprinted"><code class="language-dart"><span class="kwd">class</span><span class="pln"> </span><span class="typ">_SomeClassImpl</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">SomeClass</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />  </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> b</span><span class="pun">;</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> someMethod</span><span class="pun">()</span><span class="pln"> </span><span class="pun">...</span><span class="pln"><br /><br />  </span><span class="typ">_SomeClassImpl</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">b</span><span class="pun">);</span><span class="pln"><br /><br />  </span><span class="com">// No impersonators allowed</span><span class="pln"><br />  </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">==(</span><span class="typ">Object</span><span class="pln"> other</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"><br />    other </span><span class="kwd">is</span><span class="pln"> </span><span class="typ">_SomeClassImpl</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">a </span><span class="pun">==</span><span class="pln"> a </span><span class="pun">&amp;&amp;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">b </span><span class="pun">==</span><span class="pln"> b</span><span class="pun">;</span><span class="pln"><br /></span><span class="pun">}</span></code></pre><p>This pattern also allows you to lock down an object system where an arbitrary instance won’t fly.</p><p><code>Future</code> and <code>Zone</code> are examples from the Dart SDK. You won’t get very far trying to implement or extend either of them – at least if you try to use them in place of their native implementations.</p><p><em>This post was edited and published using <a href="https://stackedit.io/">StackEdit</a>. Freakin’ awesome. I may not ditch blogger after all.</em></p>