---
layout: post
title: 'WPF Set: Now in 3D!'
date: '2008-01-30T21:50:00.001-08:00'
author: Kevin Moore
tags:
- WPF
- ".NET"
- fun
- C#
- interesting
modified_time: '2008-01-30T21:50:00.105-08:00'
blogger_id: tag:blogger.com,1999:blog-2115056243892631308.post-4569169046000945000
blogger_orig_url: http://work.j832.com/2008/01/wpf-set-now-in-3d.html
---

<p>I last <a href="http://work.j832.com/2008/01/wpf-set-this-is-good-stopping-spot.html">discussed Set</a> about 3 weeks ago. At the time, my implementation was based on buttons. It worked fine, but when I saw how it looked on a friend's machine running the 'classic' theme I was appalled.</p>  <p>I got thinking: there has to be a way to make this game more interesting.</p>  <p>The answer: 3D and gratuitous animation.</p>  <p>The address for the XBAP hasn't changed: <a title="http://j832.com/workBlogFiles/WpfSet/" href="http://j832.com/workBlogFiles/WpfSet/">http://j832.com/workBlogFiles/WpfSet/</a></p>  <div style="text-align: center"><a href="http://j832.com/workBlogFiles/_images/WPFSetNowin3D_13301/image.png"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="373" alt="WPF Set - 3D!" src="http://j832.com/workBlogFiles/_images/WPFSetNowin3D_13301/image_thumb.png" width="400" border="0" /></a> </div>  <p>The source code has been checked-in to my <a href="http://j832.com/PublicSoftware/">SVN repository</a>. The code files actually live under <a title="http://j832.com/PublicSoftware/J832.Wpf.BagOTricksApp/" href="http://j832.com/PublicSoftware/J832.Wpf.BagOTricksApp/">J832.Wpf.BagOTricksApp</a>, but you can build and play with the stand-alone app by loading the <a href="http://j832.com/PublicSoftware/J832.WpfSet.sln">J832.WpfSet solution file</a>. (Thank you, CSProj file linking feature.)</p>  <p><strong>Cool stuff</strong>:</p>  <ul>   <li>The listbox on the right that displays the matched sets now uses AnimatingTilePanel. </li>    <li>First use of the new WPFUtil class, which exposes a set of Animate methods. These basically formalize and abstract my simple attraction-based physics model. I support 1-dimensional (double), 2-dimensional (Point/Vector), and 3-dimensional (Point3D/Vector3D) animation. Check out ZapScroller and AnimatingTilePanel in the source to see the other places these are used. </li>    <li>I've also added some helper extension methods to WPFUtil. Very useful. </li>    <li>Implemented a couple of super-simple 3D components: ButtonBase3D and ToggleButton3D. An interesting exercise. Hoping to move FlipTile3D to these in the future. </li> </ul>  <p><strong>Not cool stuff</strong>:</p>  <ul>   <li>Keyboard accessibility has evaporated. With the previous implementation, you could tab around to the buttons and press spacebar to select/unselect a &quot;card&quot;. More work than I signed up for in this iteration, but something to keep in mind. </li>    <li>WPF handles z-order great in 3D unless you have transparency in your textures. Take a look at the corners of raised cards. Very frustrating. The only work-around is to manually re-order the child elements. Lame. </li>    <li>Perf is great...on my super fast workstation. Even on my relatively beefy laptop, I notice some glitching when things are moving around. Ideally, I'd detect machines hardware limitations and degrade the animations. I should probably offer a &quot;turn off the fancy stuff&quot; check box. Eh, V3. </li> </ul>  <p>This will of course be included in the next drop of the full <a href="http://j832.com/bagotricks/">bag-o-tricks</a>, but I thought it was cool enough to share out-of-band.</p>  <p>Have fun.</p>  