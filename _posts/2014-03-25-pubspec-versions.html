---
layout: post
title: 'Dart Package Devs: Put version constraints in your pubspec'
date: '2014-03-25T12:15:00.002-07:00'
author: Kevin Moore
tags:
- dartlang
- pubspec
- dart
- pub
- versioning
modified_time: '2014-03-25T12:34:43.298-07:00'
thumbnail: http://4.bp.blogspot.com/-cM2ZP_VJ7jo/UzGun2uOYBI/AAAAAAAAAXE/J0qeM5m_0CQ/s72-c/dart_dev_y_u_no.jpg
blogger_id: tag:blogger.com,1999:blog-2115056243892631308.post-7155941204231708764
blogger_orig_url: http://work.j832.com/2014/03/pubspec-versions.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-cM2ZP_VJ7jo/UzGun2uOYBI/AAAAAAAAAXE/J0qeM5m_0CQ/s3200/dart_dev_y_u_no.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-cM2ZP_VJ7jo/UzGun2uOYBI/AAAAAAAAAXE/J0qeM5m_0CQ/s3200/dart_dev_y_u_no.jpg" /></a></div><h2>tl;dr</h2><div><ul><li>Update: <b>this guidance is specific Dart packages</b>. <i>I'll write about Dart apps soon.</i></li><li>Read about the <a href="https://www.dartlang.org/tools/pub/versioning.html">Pub Versioning Philosophy</a>.</li><li>If your package uses new features in the SDK or packages, make sure you set an <b>inclusive minimum</b> version constraint – <code>&gt;= X.Y.Z</code> – to avoid breaking folks who have not yet upgraded.</li><li>Set <b>exclusive maximum</b> version constraints – <code>&lt;X.Y.Z</code> – to make sure major releases of the SDK and packages don't break your code.</li><li>Understand how pre-v1.0 are versioned with regard to breaking changes.</li><li>Take a look at pubspec files in our SDK to understand how we handle versioning. Example: <a href="https://github.com/dart-lang/bleeding_edge/blob/master/dart/pkg/http/pubspec.yaml">http package pubspec.yaml</a>.</li></ul></div><h2>New features and minimum version constraints</h2>Dart v1.3 is coming soon. String has learned a few tricks since v1.2, specifically:<br /><ul><li>String padLeft(int newLength, String padding)</li><li>String padLeft(int newLength, String padding)</li><li>String trimLeft()</li><li>String trimRight()</li></ul>Awesome, right? I can imagine package authors doing the following:<br /><ol><li>Download Dart 1.3 Editor and SDK</li><li>Replace all internal hacks with new String functions.</li><li>Release?</li></ol>No! #3 should be: <b>Update your pubspec.yaml</b>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-6B7qiVFA4Sk/UzGuJGkx1BI/AAAAAAAAAW0/bKC5B0A8xuw/s3200/Screen+Shot+2014-03-25+at+9.25.48+AM.png" imageanchor="1"><img border="0" src="http://1.bp.blogspot.com/-6B7qiVFA4Sk/UzGuJGkx1BI/AAAAAAAAAW0/bKC5B0A8xuw/s3200/Screen+Shot+2014-03-25+at+9.25.48+AM.png" height="54" width="320" /></a></div><div style="text-align: center;">pubspec.yaml content</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-X2Vhv83Vxas/UzGuLgVxHfI/AAAAAAAAAW8/mVVslRb7-Sg/s3200/Screen+Shot+2014-03-25+at+9.25.34+AM.png" imageanchor="1"><img border="0" src="http://1.bp.blogspot.com/-X2Vhv83Vxas/UzGuLgVxHfI/AAAAAAAAAW8/mVVslRb7-Sg/s3200/Screen+Shot+2014-03-25+at+9.25.34+AM.png" height="37" width="320" /></a></div><div style="text-align: center;">In the Dart Editor</div><br />Setting the <b>minimum</b> SDK to 1.3.0 tells the pub tools and your users the users that a package requires at least v1.3 of the Dart SDK. Better to get an error from <b>pub install</b> or <b>pub update</b> than to get static warnings or runtime errors about missing functions.<br /><br />You'll also notice more than just an <b>inclusive minimum</b> SDK constraint – <code>&gt;=1.3.0</code> – there's also an <b>exclusive maximum</b> SDK constraint – <code>&lt;2.0.0.</code><br /><br />Our promise it to follow <a href="http://semver.org/">semantic versioning</a> for the SDK and our shipped packages. The short version:<br /><ul><li>For a version X.Y.Z</li><li>Increases to Y indicate new features, but no breaking changes.</li><li>Increases to X indicate breaking changes.</li></ul><div>It should be safe to set your maximum SDK version to be any release up to, but <b>not</b> including, v2.0.</div><h2>Packages and pre-v1.0</h2><div>The same applies to packages managed by the Dart team, like <a href="http://pub.dartlang.org/packages/unittest">unittest</a>, <a href="http://pub.dartlang.org/packages/args">args</a>, <a href="http://pub.dartlang.org/packages/path">path</a>, etc.</div><div><br /></div><div>We have a number of packages that are pre-v1.0 – <b>unittest</b> is a great example.</div><div><br /></div><div><b>unittest</b> is one of our oldest and most used packages. We'd really like to lock it down and clean it up before releasing something we consider v1.0.&nbsp;</div><div><br /></div><div>If you look at the <a href="https://github.com/dart-lang/bleeding_edge/blob/master/dart/pkg/unittest/CHANGELOG.md">changelog</a> for <b>unittest</b>, you'll see a number of breaking changes between v0.9.2 and v0.10.0.</div><div><br /></div><div>For pre-v1.0 packages, we bump the versioning logic up a level, so for version 0.Y.Z, changes to Y are breaking and changes to Z are non-breaking.</div><div><br /></div><div>Look again at the <a href="https://github.com/dart-lang/bleeding_edge/blob/master/dart/pkg/unittest/CHANGELOG.md">changelog</a> for <b>unittest</b>. You'll see a number of features marked as <b>DEPRECATED</b>. These are things that will likely go away – stop working – in v0.11.0 of <b>unittest</b>.</div><div><br /></div><div>If you want to make sure you code does not suddenly break, you should set a version constraint on unittest of something like <code>&gt;=0.10.0 &lt;0.11.0</code>.</div><h2>Am I missing new hotness?</h2><div>A lot of folks dislike setting maximum version constraints.</div><div><br /></div><div><i>I always want to be running the new hotness!</i></div><div><br /></div><div><i>I don't want to miss out on new features!</i></div><div><br /></div><div><b>pub upgrade</b> is your friend.</div><div><br /></div><div>If you run pub upgrade from the console or within the Dart Editor, you'll see useful hints when there are newer versions of packages than what you currently specify.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-IzC7p9fPtHI/UzHTkdzWoUI/AAAAAAAAAXU/8mhwrn4T7Q8/s1600/pub_upgrade_notice.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-IzC7p9fPtHI/UzHTkdzWoUI/AAAAAAAAAXU/8mhwrn4T7Q8/s1600/pub_upgrade_notice.png" height="316" width="400" /></a></div><br />You can then carefully update and check version constraints before you release.<br /><br />If you want to visualize a complex package with many dependencies, check out <a href="https://github.com/kevmoo/pubviz">pubviz</a>.<br /><br />Happy hacking!</div>